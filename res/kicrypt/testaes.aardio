import console; 
import kicrypt.aes;
import crypt.bin;

demo_base64 = function(){
	var t0 = time.tick();
	var text = "hKR6aJIwgnmRUzq9e/a79JavYtmchrGHTiRpwVB0A/RI0orBc7UrrYvmq46c1ZP7tozyjO4Y2ZHl1Bt5JG/99GDa7Ui9Z37nuxTovUKYLCN6prkaYW8xN2JRXKV5ir4KW4Mh7lLht68g/D9JkZsjJaiNqjfy4R9Lnw+PCXJrMQ4SSVmD4vW8DF1/leZhUu6L/80XTR3SbWTrEFRcFYTc84NdrH5AeKxZokt0zJZDzk+DG5QGSbScmihTCQXa3t5tUrYWnqSOKfCYsfwhG3QTSqTSAmtQ149UtMmor6x2QRE5T4pl6cWsX1hAqboD691SCBnE1eTiHk0LfAoyheC1Q2gX7qxLbjMb1wHxYWCqx2Rx8J2TiFaBhlVgnhi3MeqKUWKg7LPACetYg762k1uhlm7ZYbbQ7x8c/ogoI+ClB/IQTu85xv4T+u7l1pRYNJa+Fd4U346TZR7o9DweaJjX0PV72nHNjPenRNX8ew66SRcd6BDNT5M74Avcy7RJ0fhZksDVtSk/xd3xH0J5ZLY8TPwtxXl0tS0nbRinQbX0nNS7NsOH+PC4rm9x5r+C6rmSaAHur+i9fWfYibD7cZhRkivuaEAyFXdHoWsBJYcXspk+JOQ7QR+focsClLSWNyLQUb6uSoaaDCos9y4/+9x3RNz/R2r80wJPhJrbHxm8k7xPA9dFfWSgRSTd3KD0aYigfwCovjKRpuew+KgBaTrzhA=="
    var l = crypt.bin.decodeBase64(text);
    // 如果是ecb模式，iv可以不传
    var aesObj = kicrypt.aes("1234567890abcdef", "1234567890abcdef");
    var result = aesObj.decrypt(l, kicrypt.aes.CBC,kicrypt.aes.Pkcs7Padding);
    console.log("base64解密完成，花费时间: ", time.tick()-t0);
    console.log("basse64解密结果, str: ", result);
    
    var result = aesObj.encrypt(result,kicrypt.aes.CBC,kicrypt.aes.Pkcs7Padding);
    var b64Result = crypt.bin.encodeBase64(result);
    console.log("basse64加密完成，花费时间: ", time.tick()-t0);
    console.log("basse64加密结果, str: ", b64Result);
}

demo_hex = function(){
	var t0 = time.tick();
	var text = "84A47A689230827991533ABD7BF6BBF496AF62D99C86B1874E2469C1507403F448D28AC173B52BAD8BE6AB8E9CD593FBB68CF28CEE18D991E5D41B79246FFDF460DAED48BD677EE7BB14E8BD42982C237AA6B91A616F313762515CA5798ABE0A5B8321EE52E1B7AF20FC3F49919B2325A88DAA37F2E11F4B9F0F8F09726B310E12495983E2F5BC0C5D7F95E66152EE8BFFCD174D1DD26D64EB10545C1584DCF3835DAC7E4078AC59A24B74CC9643CE4F831B940649B49C9A28530905DADEDE6D52B6169EA48E29F098B1FC211B74134AA4D2026B50D78F54B4C9A8AFAC764111394F8A65E9C5AC5F5840A9BA03EBDD520819C4D5E4E21E4D0B7C0A3285E0B5436817EEAC4B6E331BD701F16160AAC76471F09D938856818655609E18B731EA8A5162A0ECB3C009EB5883BEB6935BA1966ED961B6D0EF1F1CFE882823E0A507F2104EEF39C6FE13FAEEE5D694583496BE15DE14DF8E93651EE8F43C1E6898D7D0F57BDA71CD8CF7A744D5FC7B0EBA49171DE810CD4F933BE00BDCCBB449D1F85992C0D5B5293FC5DDF11F427964B63C4CFC2DC57974B52D276D18A741B5F49CD4BB36C387F8F0B8AE6F71E6BF82EAB9926801EEAFE8BD7D67D889B0FB719851922BEE684032157747A16B01258717B2993E24E43B411F9FA1CB0294B4963722D051BEAE4A869A0C2A2CF72E3FFBDC7744DCFF476AFCD3024F849ADB1F19BC93BC4F03D7457D64A04524DDDCA0F46988A07F00A8BE3291A6E7B0F8A801693AF384"
    var l = string.unhex(text,"");
    var aesObj = kicrypt.aes("1234567890abcdef", "1234567890abcdef");
    var result = aesObj.decrypt(l, kicrypt.aes.CBC,kicrypt.aes.Pkcs7Padding);
    console.log("hex解密完成，花费时间: ", time.tick()-t0);
    console.log("hex解密结果, str: ", result);
    
    var result = aesObj.encrypt(result,kicrypt.aes.CBC,kicrypt.aes.Pkcs7Padding);
    var b64Result = string.hex(result,"");
    console.log("basse64加密完成，花费时间: ", time.tick()-t0);
    console.log("basse64加密结果, str: ", b64Result);
}


demo_base64()
demo_hex()
console.pause(true);